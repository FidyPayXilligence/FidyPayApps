package com.fidypay.encryption;

import javax.crypto.*;
import javax.crypto.spec.IvParameterSpec;
import javax.crypto.spec.PBEKeySpec;
import javax.crypto.spec.SecretKeySpec;
import java.nio.charset.StandardCharsets;
import java.security.InvalidAlgorithmParameterException;
import java.security.InvalidKeyException;
import java.security.NoSuchAlgorithmException;
import java.security.spec.InvalidKeySpecException;
import java.security.spec.KeySpec;
import java.util.Base64;

public class EncryptionDataRequest {
	
	private static final String SECRET_KEY = "9874%^&*($#@";
	private static final String SALT_VALUE = "FidyPay";
	
	public static String encrypt(String text) {
		String finalResponse = null;
		
		try {
			byte[] iv = { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
			IvParameterSpec ivspec = new IvParameterSpec(iv);
			
			SecretKeyFactory keyFactory = SecretKeyFactory.getInstance("PBKDF2WithHmacSHA256");
			
			KeySpec keySpec = new PBEKeySpec(SECRET_KEY.toCharArray(), SALT_VALUE.getBytes(), 65536, 256);
			SecretKey tmp = keyFactory.generateSecret(keySpec);
			SecretKeySpec secretKey = new SecretKeySpec(tmp.getEncoded(), "AES");
			Cipher cipher = Cipher.getInstance("AES/CBC/PKCS5Padding");
			cipher.init(Cipher.ENCRYPT_MODE, secretKey, ivspec);
			
			finalResponse = Base64.getEncoder().encodeToString(cipher.doFinal(text.getBytes(StandardCharsets.UTF_8)));
			return finalResponse;
				
		} catch (InvalidAlgorithmParameterException | InvalidKeyException | NoSuchAlgorithmException
				| InvalidKeySpecException | BadPaddingException | IllegalBlockSizeException | NoSuchPaddingException e) {
			finalResponse = e.toString();
		}
		return finalResponse;
	}
	
	public static String decrypt(String text) {
		String finalResponse = null;
		
		try {
			byte[] iv = { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
			IvParameterSpec ivspec = new IvParameterSpec(iv);

			SecretKeyFactory factory = SecretKeyFactory.getInstance("PBKDF2WithHmacSHA256");

			KeySpec spec = new PBEKeySpec(SECRET_KEY.toCharArray(), SALT_VALUE.getBytes(), 65536, 256);
			SecretKey tmp = factory.generateSecret(spec);
			SecretKeySpec secretKey = new SecretKeySpec(tmp.getEncoded(), "AES");
			Cipher cipher = Cipher.getInstance("AES/CBC/PKCS5PADDING");
			cipher.init(Cipher.DECRYPT_MODE, secretKey, ivspec);

			finalResponse = new String(cipher.doFinal(Base64.getDecoder().decode(text)));

			return finalResponse;
		} catch (InvalidAlgorithmParameterException | InvalidKeyException | NoSuchAlgorithmException
				| InvalidKeySpecException | BadPaddingException | IllegalBlockSizeException
				| NoSuchPaddingException e) {
			e.printStackTrace();

		}
		return finalResponse;
	}
	
	public static void main(String[] args) {
		String decryp = decrypt("tgdmBBbRFhbc7ms/2Uc3DTCPKqCFsg2AszMlGHy1wlkTXMmicPgRZRwMr4v/reJ41ZpP2JvCKT0X13o612n7Uh7GHhvTy5Gon/yUVxiTnOBx3keoXoH6uYRlddgkFtxJZYVsyqULtlj8f6fa/P51OyC6MlUOdTnJiIMWwaKjtXpfeMGk4nipEhFMfUsqoD2N/Pu88VsA8TiGTe6UZ0xO0GLs22X4dGXcwoIu6Wm3Ksc=");
		System.out.println(decryp);
	}

//	public static void main(String[] args) {
//		String encry = encrypt("{\"code\":\"0x0200\",\"data\":[{\"beneficiaryId\":\"136\",\"beneficiaryName\":\"Arpan\",\"beneficiaryAccountNumber\":\"748176892308\",\"beneficiaryIFSC\":\"PUNB0659500\",\"beneficiaryBankName\":\"PNB\",\"beneficiaryMobileNumber\":\"7869920537\",\"beneficiaryAccountType\":\"saving\",\"beneficiaryRegisterDate\":\"2023-07-14 18:46:06.0\",\"beneficiaryKey\":\"290BANKEY2PAKXOAHB0\",\"isActive\":\"Y\",\"beneficiaryEmail\":\"arpan.sethiya@fidypay.com\",\"beneficiaryAddress\":\"Indore\",\"beneficiaryAccountNumberX\":\"XX2308\"},{\"beneficiaryId\":\"137\",\"beneficiaryName\":\"Arpan\",\"beneficiaryAccountNumber\":\"748176892398\",\"beneficiaryIFSC\":\"PUNB0659500\",\"beneficiaryBankName\":\"PNB\",\"beneficiaryMobileNumber\":\"7869920537\",\"beneficiaryAccountType\":\"saving\",\"beneficiaryRegisterDate\":\"2023-07-14 19:00:32.0\",\"beneficiaryKey\":\"290BANKEYLDATGIWCEY\",\"isActive\":\"Y\",\"beneficiaryEmail\":\"arpan.sethiya@fidypay.com\",\"beneficiaryAddress\":\"Indore\",\"beneficiaryAccountNumberX\":\"XX2398\"},{\"beneficiaryId\":\"140\",\"beneficiaryName\":\"Arpan\",\"beneficiaryAccountNumber\":\"8597459467347\",\"beneficiaryIFSC\":\"PUNB0659500\",\"beneficiaryBankName\":\"PNB\",\"beneficiaryMobileNumber\":\"7869920537\",\"beneficiaryAccountType\":\"current\",\"beneficiaryRegisterDate\":\"2023-07-17 13:47:47.0\",\"beneficiaryKey\":\"290BANKEYGP8G5G5ZIY\",\"isActive\":\"Y\",\"beneficiaryEmail\":\"arpan.sethiya@fidypay.com\",\"beneficiaryAddress\":\"Indore\",\"beneficiaryAccountNumberX\":\"XX7347\"},{\"beneficiaryId\":\"142\",\"beneficiaryName\":\"Ankush          Gaurkhede\",\"beneficiaryAccountNumber\":\"4444444444\",\"beneficiaryIFSC\":\"ICIC0TREA00\",\"beneficiaryBankName\":\"ICICI Bank\",\"beneficiaryMobileNumber\":\"9511204217\",\"beneficiaryAccountType\":\"Savings\",\"beneficiaryRegisterDate\":\"2023-07-18 11:25:28.0\",\"beneficiaryKey\":\"290BANKEYA5HQ8KFTMM\",\"isActive\":\"Y\",\"beneficiaryEmail\":\"a1@gmail.111\",\"beneficiaryAddress\":\"Indore\",\"beneficiaryAccountNumberX\":\"XX4444\"},{\"beneficiaryId\":\"143\",\"beneficiaryName\":\"ankush\",\"beneficiaryAccountNumber\":\"eede323232\",\"beneficiaryIFSC\":\"ICIC0TREA00\",\"beneficiaryBankName\":\"ICICI Bank\",\"beneficiaryMobileNumber\":\"9511204217\",\"beneficiaryAccountType\":\"Cash Credit\",\"beneficiaryRegisterDate\":\"2023-07-18 11:27:03.0\",\"beneficiaryKey\":\"290BANKEY9X4C1A5KCI\",\"isActive\":\"Y\",\"beneficiaryEmail\":\"ab@gmail.coo\",\"beneficiaryAddress\":\"indore\",\"beneficiaryAccountNumberX\":\"XX3232\"},{\"beneficiaryId\":\"144\",\"beneficiaryName\":\"Pankaj Sharma\",\"beneficiaryAccountNumber\":\"91919131\",\"beneficiaryIFSC\":\"ICIC0TREA00\",\"beneficiaryBankName\":\"ICICI Bank\",\"beneficiaryMobileNumber\":\"9511204217\",\"beneficiaryAccountType\":\"Cash Credit\",\"beneficiaryRegisterDate\":\"2023-07-18 11:29:30.0\",\"beneficiaryKey\":\"290BANKEY4UTQ3BE8PU\",\"isActive\":\"Y\",\"beneficiaryEmail\":\"pankaj.sharma@fidypay.com\",\"beneficiaryAddress\":\"Indore\",\"beneficiaryAccountNumberX\":\"XX9131\"},{\"beneficiaryId\":\"145\",\"beneficiaryName\":\"Ankush Gaurkhede\",\"beneficiaryAccountNumber\":\"33333333333\",\"beneficiaryIFSC\":\"ICIC0TREA00\",\"beneficiaryBankName\":\"ICICI Bank\",\"beneficiaryMobileNumber\":\"9511204217\",\"beneficiaryAccountType\":\"Savings\",\"beneficiaryRegisterDate\":\"2023-07-24 19:28:36.0\",\"beneficiaryKey\":\"290BANKEYWBU4RE9SSV\",\"isActive\":\"Y\",\"beneficiaryEmail\":\"pankaj.sharma@fidypay.com\",\"beneficiaryAddress\":\"sdfdfssssssssssssssssssssssssssssssssssssssss\",\"beneficiaryAccountNumberX\":\"XX3333\"},{\"beneficiaryId\":\"146\",\"beneficiaryName\":\"ankush\",\"beneficiaryAccountNumber\":\"34234324324\",\"beneficiaryIFSC\":\"ICIC0TREA00\",\"beneficiaryBankName\":\"ICICI Bank\",\"beneficiaryMobileNumber\":\"9511204217\",\"beneficiaryAccountType\":\"Savings\",\"beneficiaryRegisterDate\":\"2023-07-24 19:30:41.0\",\"beneficiaryKey\":\"290BANKEYD22CVL8OBK\",\"isActive\":\"Y\",\"beneficiaryEmail\":\"ankush.gaurkhede@fidypay.com\",\"beneficiaryAddress\":\"ab\",\"beneficiaryAccountNumberX\":\"XX4324\"},{\"beneficiaryId\":\"147\",\"beneficiaryName\":\"Ankush\",\"beneficiaryAccountNumber\":\"11111111\",\"beneficiaryIFSC\":\"ICIC0TREA00\",\"beneficiaryBankName\":\"ICICI Bank\",\"beneficiaryMobileNumber\":\"9511204217\",\"beneficiaryAccountType\":\"Current\",\"beneficiaryRegisterDate\":\"2023-07-24 19:55:41.0\",\"beneficiaryKey\":\"290BANKEYD0DGDSUAV9\",\"isActive\":\"Y\",\"beneficiaryEmail\":\"ankush.gaurkhede@fidypay.com\",\"beneficiaryAddress\":\"Djdhdhdhejdjdhdhdhdhdhdhdbcbcbdhdhdhjdjsjsjsh\",\"beneficiaryAccountNumberX\":\"XX1111\"},{\"beneficiaryId\":\"148\",\"beneficiaryName\":\"Ankush Gaurkhede\",\"beneficiaryAccountNumber\":\"432432432432\",\"beneficiaryIFSC\":\"ICIC0TREA00\",\"beneficiaryBankName\":\"ICICI Bank\",\"beneficiaryMobileNumber\":\"9511204217\",\"beneficiaryAccountType\":\"Current\",\"beneficiaryRegisterDate\":\"2023-07-24 20:53:53.0\",\"beneficiaryKey\":\"290BANKEYPL7ELAQBAR\",\"isActive\":\"Y\",\"beneficiaryEmail\":\"ankush.gaurkhede@fidypay.com\",\"beneficiaryAddress\":\"ward. no.1  tq.ujjain Dist indore Pin- 443333\",\"beneficiaryAccountNumberX\":\"XX2432\"},{\"beneficiaryId\":\"149\",\"beneficiaryName\":\"Jitendra Yaduvanshi\",\"beneficiaryAccountNumber\":\"3333333333\",\"beneficiaryIFSC\":\"CBIN0283755\",\"beneficiaryBankName\":\"Central Bank of India\",\"beneficiaryMobileNumber\":\"9511204217\",\"beneficiaryAccountType\":\"Current\",\"beneficiaryRegisterDate\":\"2023-07-25 10:58:09.0\",\"beneficiaryKey\":\"290BANKEY5KXIWR35QV\",\"isActive\":\"Y\",\"beneficiaryEmail\":\"jitendra.yaduvanshi@fidypay.com\",\"beneficiaryAddress\":\"104, First Floor, New IT Park, Electronics Co\",\"beneficiaryAccountNumberX\":\"XX3333\"},{\"beneficiaryId\":\"150\",\"beneficiaryName\":\"Ankush aaaaaaaaaaaaaaaaaa\",\"beneficiaryAccountNumber\":\"99999999999999999999\",\"beneficiaryIFSC\":\"CBIN0283755\",\"beneficiaryBankName\":\"Central Bank of India\",\"beneficiaryMobileNumber\":\"9511204217\",\"beneficiaryAccountType\":\"Cash Credit\",\"beneficiaryRegisterDate\":\"2023-07-25 16:43:30.0\",\"beneficiaryKey\":\"290BANKEYXIIIVVMXPR\",\"isActive\":\"Y\",\"beneficiaryEmail\":\"ankush.gaurkdsadsdsadsdsadsadhede@gmail.com\",\"beneficiaryAddress\":\"104, First Floor, New IT Park,\",\"beneficiaryAccountNumberX\":\"XX9999\"},{\"beneficiaryId\":\"151\",\"beneficiaryName\":\"Ankush Gaurkhede\",\"beneficiaryAccountNumber\":\"333333333333\",\"beneficiaryIFSC\":\"ICIC0TREA00\",\"beneficiaryBankName\":\"ICICI Bank\",\"beneficiaryMobileNumber\":\"9511204217\",\"beneficiaryAccountType\":\"Credit Card\",\"beneficiaryRegisterDate\":\"2023-07-25 17:22:09.0\",\"beneficiaryKey\":\"290BANKEYYXUVUD1TGT\",\"isActive\":\"Y\",\"beneficiaryEmail\":\"ankush.gaurkhede@fidypay.com\",\"beneficiaryAddress\":\"ab\",\"beneficiaryAccountNumberX\":\"XX3333\"},{\"beneficiaryId\":\"152\",\"beneficiaryName\":\"Jitendra\",\"beneficiaryAccountNumber\":\"4443543543543\",\"beneficiaryIFSC\":\"ICIC0TREA00\",\"beneficiaryBankName\":\"ICICI Bank\",\"beneficiaryMobileNumber\":\"9511204217\",\"beneficiaryAccountType\":\"Cash Credit\",\"beneficiaryRegisterDate\":\"2023-07-26 11:29:16.0\",\"beneficiaryKey\":\"290BANKEY4UUUZLHJC7\",\"isActive\":\"Y\",\"beneficiaryEmail\":\"ankush.gaurkhede@fidypay.com\",\"beneficiaryAddress\":\"104, First Floor, New IT Park,\",\"beneficiaryAccountNumberX\":\"XX3543\"},{\"beneficiaryId\":\"153\",\"beneficiaryName\":\"testing\",\"beneficiaryAccountNumber\":\"434343434\",\"beneficiaryIFSC\":\"ICIC0TREA00\",\"beneficiaryBankName\":\"ICICI Bank\",\"beneficiaryMobileNumber\":\"9511204217\",\"beneficiaryAccountType\":\"Savings\",\"beneficiaryRegisterDate\":\"2023-07-26 12:51:07.0\",\"beneficiaryKey\":\"290BANKEY3T8I9TEM1G\",\"isActive\":\"Y\",\"beneficiaryEmail\":\"ankush.gaurkhede@fidypay.com\",\"beneficiaryAddress\":\"Indore 12,Indore 12,Indore 12,\",\"beneficiaryAccountNumberX\":\"XX3434\"},{\"beneficiaryId\":\"154\",\"beneficiaryName\":\"fidy testing \",\"beneficiaryAccountNumber\":\"5654654654\",\"beneficiaryIFSC\":\"ICIC0TREA00\",\"beneficiaryBankName\":\"ICICI Bank\",\"beneficiaryMobileNumber\":\"9511204217\",\"beneficiaryAccountType\":\"Credit Card\",\"beneficiaryRegisterDate\":\"2023-07-26 13:29:50.0\",\"beneficiaryKey\":\"290BANKEY369VCHV7ET\",\"isActive\":\"Y\",\"beneficiaryEmail\":\"ankush.gaurkhede@fidypay.com\",\"beneficiaryAddress\":\"sadsadsdsads212313213213213213\",\"beneficiaryAccountNumberX\":\"XX4654\"},{\"beneficiaryId\":\"155\",\"beneficiaryName\":\"pradeep\",\"beneficiaryAccountNumber\":\"4454543543534\",\"beneficiaryIFSC\":\"ICIC0TREA00\",\"beneficiaryBankName\":\"ICICI Bank\",\"beneficiaryMobileNumber\":\"9511204217\",\"beneficiaryAccountType\":\"Savings\",\"beneficiaryRegisterDate\":\"2023-07-26 15:15:31.0\",\"beneficiaryKey\":\"290BANKEY5AJQA6EKYP\",\"isActive\":\"Y\",\"beneficiaryEmail\":\"ankush.gaurkhede@fidypay.com\",\"beneficiaryAddress\":\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\",\"beneficiaryAccountNumberX\":\"XX3534\"},{\"beneficiaryId\":\"156\",\"beneficiaryName\":\"Arpan\",\"beneficiaryAccountNumber\":\"987452631452\",\"beneficiaryIFSC\":\"PUNB0659500\",\"beneficiaryBankName\":\"PNB BANK\",\"beneficiaryMobileNumber\":\"987452631452\",\"beneficiaryAccountType\":\"ABC\",\"beneficiaryRegisterDate\":\"2023-07-26 17:07:31.0\",\"beneficiaryKey\":\"290BANKEYUNXQ3RNXHZ\",\"isActive\":\"Y\",\"beneficiaryEmail\":\"arpan.sethiya@fidypay.com\",\"beneficiaryAddress\":\"Indore\",\"beneficiaryAccountNumberX\":\"XX1452\"},{\"beneficiaryId\":\"158\",\"beneficiaryName\":\"Arpan\",\"beneficiaryAccountNumber\":\"809521632275\",\"beneficiaryIFSC\":\"PUNB0659500\",\"beneficiaryBankName\":\"PNB BANK\",\"beneficiaryMobileNumber\":\"987452631452\",\"beneficiaryAccountType\":\"2\",\"beneficiaryRegisterDate\":\"2023-08-04 12:41:38.0\",\"beneficiaryKey\":\"290BANKEYLC3TJVJ2F1\",\"isActive\":\"Y\",\"beneficiaryEmail\":\"arpan.sethiya@fidypay.com\",\"beneficiaryAddress\":\"Indore\",\"beneficiaryAccountNumberX\":\"XX2275\"},{\"beneficiaryId\":\"159\",\"beneficiaryName\":\"Arpan\",\"beneficiaryAccountNumber\":\"09521632275\",\"beneficiaryIFSC\":\"PUNB0659500\",\"beneficiaryBankName\":\"PNB BANK\",\"beneficiaryMobileNumber\":\"987452631452\",\"beneficiaryAccountType\":\"2\",\"beneficiaryRegisterDate\":\"2023-08-04 12:56:03.0\",\"beneficiaryKey\":\"290BANKEYB1D8JWIRK2\",\"isActive\":\"Y\",\"beneficiaryEmail\":\"arpan.sethiya@fidypay.com\",\"beneficiaryAddress\":\"Indore\",\"beneficiaryAccountNumberX\":\"XX2275\"},{\"beneficiaryId\":\"160\",\"beneficiaryName\":\"Arpan\",\"beneficiaryAccountNumber\":\"9758660682\",\"beneficiaryIFSC\":\"PUNB0659500\",\"beneficiaryBankName\":\"PNB BANK\",\"beneficiaryMobileNumber\":\"987452631452\",\"beneficiaryAccountType\":\"2\",\"beneficiaryRegisterDate\":\"2023-08-04 12:59:40.0\",\"beneficiaryKey\":\"290BANKEYPIF60A2TX4\",\"isActive\":\"Y\",\"beneficiaryEmail\":\"arpan.sethiya@fidypay.com\",\"beneficiaryAddress\":\"Indore\",\"beneficiaryAccountNumberX\":\"XX0682\"},{\"beneficiaryId\":\"161\",\"beneficiaryName\":\"Arpan\",\"beneficiaryAccountNumber\":\"9758660680\",\"beneficiaryIFSC\":\"INDB0000001\",\"beneficiaryBankName\":\"PNB BANK\",\"beneficiaryMobileNumber\":\"987452631452\",\"beneficiaryAccountType\":\"2\",\"beneficiaryRegisterDate\":\"2023-08-10 12:07:34.0\",\"beneficiaryKey\":\"290BANKEY4ZT66VSTAR\",\"isActive\":\"Y\",\"beneficiaryEmail\":\"arpan.sethiyafidypay.com\",\"beneficiaryAddress\":\"Indore\",\"beneficiaryAccountNumberX\":\"XX0680\"},{\"beneficiaryId\":\"162\",\"beneficiaryName\":\"Arpan\",\"beneficiaryAccountNumber\":\"009826210273\",\"beneficiaryIFSC\":\"PUNB0659500\",\"beneficiaryBankName\":\"PNB BANK\",\"beneficiaryMobileNumber\":\"9826210273\",\"beneficiaryAccountType\":\"2\",\"beneficiaryRegisterDate\":\"2023-08-10 13:02:50.0\",\"beneficiaryKey\":\"290BANKEY7BKGDBJ53G\",\"isActive\":\"Y\",\"beneficiaryEmail\":\"pankaj.sharma@fidypay.com\",\"beneficiaryAddress\":\"Indore\",\"beneficiaryAccountNumberX\":\"XX0273\"},{\"beneficiaryId\":\"163\",\"beneficiaryName\":\"Arpan\",\"beneficiaryAccountNumber\":\"8989897878\",\"beneficiaryIFSC\":\"PUNB0659500\",\"beneficiaryBankName\":\"PNB BANK\",\"beneficiaryMobileNumber\":\"987452631452\",\"beneficiaryAccountType\":\"2\",\"beneficiaryRegisterDate\":\"2023-08-16 13:59:43.0\",\"beneficiaryKey\":\"290BANKEYY5WHTI0M4N\",\"isActive\":\"Y\",\"beneficiaryEmail\":\"arpan.sethiya@fidypay.com\",\"beneficiaryAddress\":\"Indore\",\"beneficiaryAccountNumberX\":\"XX7878\"},{\"beneficiaryId\":\"164\",\"beneficiaryName\":\"Arpan\",\"beneficiaryAccountNumber\":\"87654343\",\"beneficiaryIFSC\":\"PUNB0659500\",\"beneficiaryBankName\":\"PNB BANK\",\"beneficiaryMobileNumber\":\"987452631452\",\"beneficiaryAccountType\":\"2\",\"beneficiaryRegisterDate\":\"2023-08-16 14:04:08.0\",\"beneficiaryKey\":\"290BANKEY43X3WXO2M1\",\"isActive\":\"Y\",\"beneficiaryEmail\":\"arpan.sethiya@fidypay.com\",\"beneficiaryAddress\":\"Indore\",\"beneficiaryAccountNumberX\":\"XX4343\"},{\"beneficiaryId\":\"165\",\"beneficiaryName\":\"Arpan\",\"beneficiaryAccountNumber\":\"877667676\",\"beneficiaryIFSC\":\"PUNB0659500\",\"beneficiaryBankName\":\"PNB BANK\",\"beneficiaryMobileNumber\":\"987452631452\",\"beneficiaryAccountType\":\"2\",\"beneficiaryRegisterDate\":\"2023-08-16 15:07:28.0\",\"beneficiaryKey\":\"290BANKEYN39JPCJAE8\",\"isActive\":\"Y\",\"beneficiaryEmail\":\"arpan.sethiya@fidypay.com\",\"beneficiaryAddress\":\"Indore\",\"beneficiaryAccountNumberX\":\"XX7676\"}],\"description\":\"Data Found Successfully\",\"status\":\"Success\"}\n");
//
//		System.out.println(encry);
//	}
}
